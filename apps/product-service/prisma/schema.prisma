generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "mongodb"
  url      = env("PRODUCT_MS_DATABASE_URL")
}

model ProductBase {
  id       String         @id @default(auto()) @map("_id") @db.ObjectId
  name     String
  category Category
  offers   ProductOffer[]

  @@map("product_bases")
}


model ProductOffer {
  id            String      @id @default(auto()) @map("_id") @db.ObjectId
  productBaseId String      @db.ObjectId
  productBase   ProductBase @relation(fields: [productBaseId], references: [id])
  producerId    String
  name          String
  description   String
  price         Float
  isAvailable Boolean @default(true)
  isActive    Boolean  @default(false) // o status: 'PENDING'
  imageUrl    String
  unit        Unit // Unidad en la que SE VENDE (ej: bulto, kilo, gramo, caja)

  // Cantidad equivalente de esa unidad en UNIDAD BASE (ej: gramos)
  // Si unidad="KG" → quantityPerUnit = 1000 (gramos)
  // Si unidad="BULTO" → quantityPerUnit = 25000 (gramos)
  // Si unidad="GRAMO" → quantityPerUnit = 1
  quantity  Float
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([productBaseId])
  @@index([producerId])
  @@map("product_offers")
}

enum Category {
  FRUTAS
  VERDURAS
  GRANOS
  LEGUMINOSAS
  TUBERCULOS
  HIERBAS
  ESPECIAS
  SEMILLAS
  NUECES
  ACEITES
  LACTEOS
  CARNES
  AVES
  HUEVOS
  PESCADOS
  MIEL
  CAFE
  CACAO
  FLORES
  PLANTAS
  COMPOSTA
  FERTILIZANTES
  ALIMENTO_ANIMAL
  BEBIDAS
  PROCESADOS
}

enum Unit {
  KILOGRAMO    @map("Kg")
  GRAMO        @map("g")
  LITRO        @map("L")
  MILILITRO    @map("mL")
  TONELADA     @map("t")
  LIBRA        @map("lb")
  ARROBA       @map("arroba")
  CARGA        @map("Carga")
  BULTO        @map("Bulto")
  SACO         @map("Saco")
  CAJA         @map("Caja")
  CANASTA      @map("Canasta")
  ATADO        @map("Atado")
  MANOJO       @map("Manojo")
  RACIMO       @map("Racimo")
  UNIDAD       @map("Unidad")
  DOCENA       @map("Docena")
  MEDIA_DOCENA @map("Media_docena")
  PAR          @map("Par")
  CUARTILLA    @map("Cuartilla")
  BOTELLA      @map("Botella")
}
